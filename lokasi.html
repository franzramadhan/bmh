<!DOCTYPE html>
<html>
<head lang="en">
    <title></title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta charset="utf-8">


    <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
    <link rel="stylesheet" href="assets/css/jquery.mobile-1.4.3.min.css" />
    <script src="assets/js/jquery-1.11.1.min.js"></script>
    <script src="assets/js/jquery.mobile-1.4.3.min.js"></script>
    <script src="http://maps.google.com/maps/api/js?v=3&sensor=true&language=id"></script>
    <style>
        body {
            background: url(assets/images/bg.png) repeat fixed;
            background-size:auto;
        }

        .ui-content, .ui-btn {
            background: transparent;
        }
    </style>
</head>
<body>


<div id="lokasi" data-role="page" class="jqm-demos ui-responsive-panel">
    <script>
        var directionsDisplay;
        var directionsService = new google.maps.DirectionsService();
        var map;
        var marker;

        function initialize(lat, lng) {
            directionsDisplay = new google.maps.DirectionsRenderer();
            var bmh = new google.maps.LatLng(lat, lng);
            var myOptions = {
                zoom: 15,
                center: bmh,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);

            marker = new google.maps.Marker({
                position: bmh,
                map: map,
                animation: google.maps.Animation.DROP ,
                title : "Baitul Maal Hidayatullah"
            });

            directionsDisplay.setMap(map);
            google.maps.event.addListener(marker, 'click', toggleBounce);
        }

        function calcRoute() {
            var start = function posisiAnda() {
                if(navigator.geolocation){
                    navigator.geolocation.getCurrentPosition(function(position){
                       return position.coords.latitude+','+position.coords.longitude;
                    });
                }
            }
            var end = new google.maps.LatLng(-6.253687, 106.844001);
            var request = {
                origin:start,
                destination:end,
                travelMode: google.maps.TravelMode.DRIVING
            };
            directionsService.route(request, function(result, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(result);
                }
            });
        }

        function toggleBounce() {

            if (marker.getAnimation() != null) {
                marker.setAnimation(null);
            } else {
                marker.setAnimation(google.maps.Animation.BOUNCE);
            }
        }

        $(document).on("pageinit","#lokasi", function (e, data) {
            initialize(-6.253687, 106.844001);
            calcRoute();
        });
    </script>

    <div data-role="header">
        <h1>Lokasi</h1>
        <a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
    </div>
    <div role="main" class="ui-content jqm-content jqm-fullwidth">
        <div id="map_canvas"
            style="display:block;
            overflow:hidden;
            position:relative;
            border:1px solid #aaaaaa;
            width: 100%;
            height: 400px;">
        </div>
    </div>
    <div data-role="panel" data-display="push" data-theme="b" id="nav-panel">
        <ul data-role="listview">
            <li data-icon="delete"><a href="#" data-rel="close">Close menu</a></li>
            <li><a href="index.html" data-transition="slide">Home</a></li>
            <li><a href="profile.html" data-transition="slide">Profil</a></li>
            <li><a href="lokasi.html" data-transition="slide">Lokasi</a></li>
            <li><a href="news.html" data-transition="slide">Berita</a></li>
            <li><a href="zis.html" data-transition="slide">ZIS</a></li>
            <li><a href="qurban.html" data-transition="slide">Qurban</a></li>
            <li><a href="calc.html" data-transition="slide">Kalkulator Zakat</a></li>
            <li><a href="donasi.html" data-transition="slide">Layanan Donatur</a></li>
        </ul>
    </div><!-- /panel -->
</div>
</body>
</html>